{"ast":null,"code":"\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = Object.setPrototypeOf || {\n    __proto__: []\n  } instanceof Array && function (d, b) {\n    d.__proto__ = b;\n  } || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n  };\n  return function (d, b) {\n    extendStatics(d, b);\n    function __() {\n      this.constructor = d;\n    }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar React = require(\"react\");\nvar InteractionEvents;\n(function (InteractionEvents) {\n  InteractionEvents[\"MouseDown\"] = \"mousedown\";\n  InteractionEvents[\"MouseMove\"] = \"mousemove\";\n  InteractionEvents[\"MouseUp\"] = \"mouseup\";\n  InteractionEvents[\"TouchStart\"] = \"touchstart\";\n  InteractionEvents[\"TouchMove\"] = \"touchmove\";\n  InteractionEvents[\"TouchEnd\"] = \"touchend\";\n})(InteractionEvents || (InteractionEvents = {}));\nvar Joystick = /** @class */function (_super) {\n  __extends(Joystick, _super);\n  function Joystick(props) {\n    var _this = _super.call(this, props) || this;\n    _this.state = {\n      dragging: false\n    };\n    _this._stickRef = React.createRef();\n    _this._baseRef = React.createRef();\n    _this._throttleMoveCallback = function () {\n      var lastCall = 0;\n      return function (event) {\n        var now = new Date().getTime();\n        var throttleAmount = _this.props.throttle || 0;\n        if (now - lastCall < throttleAmount) {\n          return;\n        }\n        lastCall = now;\n        if (_this.props.move) {\n          return _this.props.move(event);\n        }\n      };\n    }();\n    _this._boundMouseUp = function () {\n      _this._mouseUp();\n    };\n    _this._boundMouseMove = function (event) {\n      _this._mouseMove(event);\n    };\n    return _this;\n  }\n  Joystick.prototype._updatePos = function (coordinates) {\n    var _this = this;\n    window.requestAnimationFrame(function () {\n      _this.setState({\n        coordinates: coordinates\n      });\n    });\n    this._throttleMoveCallback({\n      type: \"move\",\n      x: coordinates.relativeX,\n      y: -coordinates.relativeY,\n      direction: coordinates.direction\n    });\n  };\n  Joystick.prototype._mouseDown = function (e) {\n    if (this.props.disabled !== true) {\n      this._parentRect = this._baseRef.current.getBoundingClientRect();\n      this.setState({\n        dragging: true\n      });\n      if (e.type === InteractionEvents.MouseDown) {\n        window.addEventListener(InteractionEvents.MouseUp, this._boundMouseUp);\n        window.addEventListener(InteractionEvents.MouseMove, this._boundMouseMove);\n      } else {\n        window.addEventListener(InteractionEvents.TouchEnd, this._boundMouseUp);\n        window.addEventListener(InteractionEvents.TouchMove, this._boundMouseMove);\n      }\n      if (this.props.start) {\n        this.props.start({\n          type: \"start\",\n          x: null,\n          y: null,\n          direction: null\n        });\n      }\n    }\n  };\n  Joystick.prototype._getDirection = function (atan2) {\n    if (atan2 > 2.35619449 || atan2 < -2.35619449) {\n      return \"FORWARD\";\n    } else if (atan2 < 2.35619449 && atan2 > 0.785398163) {\n      return \"RIGHT\";\n    } else if (atan2 < -0.785398163) {\n      return \"LEFT\";\n    }\n    return \"BACKWARD\";\n  };\n  Joystick.prototype._getWithinBounds = function (value) {\n    var halfBaseSize = this._baseSize / 2;\n    if (value > halfBaseSize) {\n      return halfBaseSize;\n    }\n    if (value < -halfBaseSize) {\n      return halfBaseSize * -1;\n    }\n    return value;\n  };\n  Joystick.prototype._mouseMove = function (event) {\n    if (this.state.dragging) {\n      var absoluteX = null;\n      var absoluteY = null;\n      if (event.type === InteractionEvents.MouseMove) {\n        absoluteX = event.clientX;\n        absoluteY = event.clientY;\n      } else {\n        absoluteX = event.touches[0].clientX;\n        absoluteY = event.touches[0].clientY;\n      }\n      var relativeX = this._getWithinBounds(absoluteX - this._parentRect.left - this._baseSize / 2);\n      var relativeY = this._getWithinBounds(absoluteY - this._parentRect.top - this._baseSize / 2);\n      var atan2 = Math.atan2(relativeX, relativeY);\n      this._updatePos({\n        relativeX: relativeX,\n        relativeY: relativeY,\n        direction: this._getDirection(atan2),\n        axisX: absoluteX - this._parentRect.left,\n        axisY: absoluteY - this._parentRect.top\n      });\n    }\n  };\n  Joystick.prototype._mouseUp = function () {\n    this.setState({\n      dragging: false,\n      coordinates: undefined\n    });\n    window.removeEventListener(\"mouseup\", this._boundMouseUp);\n    window.removeEventListener(\"mousemove\", this._boundMouseMove);\n    if (this.props.stop) {\n      this.props.stop({\n        type: \"stop\",\n        x: null,\n        y: null,\n        direction: null\n      });\n    }\n  };\n  Joystick.prototype._getBaseStyle = function () {\n    var baseColor = this.props.baseColor !== undefined ? this.props.baseColor : \"#000033\";\n    var baseSizeString = this._baseSize + \"px\";\n    return {\n      height: baseSizeString,\n      width: baseSizeString,\n      background: baseColor,\n      borderRadius: this._baseSize,\n      display: 'flex',\n      justifyContent: 'center',\n      alignItems: 'center'\n    };\n  };\n  Joystick.prototype._getStickStyle = function () {\n    var stickColor = this.props.stickColor !== undefined ? this.props.stickColor : \"#3D59AB\";\n    var stickSize = this._baseSize / 1.5 + \"px\";\n    var stickStyle = {\n      background: stickColor,\n      cursor: \"move\",\n      height: stickSize,\n      width: stickSize,\n      borderRadius: this._baseSize,\n      flexShrink: 0\n    };\n    if (this.state.dragging && this.state.coordinates !== undefined) {\n      stickStyle = Object.assign({}, stickStyle, {\n        position: 'absolute',\n        transform: \"translate3d(\" + this.state.coordinates.relativeX + \"px, \" + this.state.coordinates.relativeY + \"px, 0)\"\n      });\n    }\n    return stickStyle;\n  };\n  Joystick.prototype.render = function () {\n    this._baseSize = this.props.size || 100;\n    var baseStyle = this._getBaseStyle();\n    var stickStyle = this._getStickStyle();\n    return React.createElement(\"div\", {\n      className: this.props.disabled ? 'joystick-base-disabled' : '',\n      onMouseDown: this._mouseDown.bind(this),\n      onTouchStart: this._mouseDown.bind(this),\n      ref: this._baseRef,\n      style: baseStyle\n    }, React.createElement(\"div\", {\n      ref: this._stickRef,\n      className: this.props.disabled ? 'joystick-disabled' : '',\n      style: stickStyle\n    }));\n  };\n  return Joystick;\n}(React.Component);\nexports.Joystick = Joystick;","map":{"version":3,"names":["React","require","InteractionEvents","Joystick","_super","__extends","props","_this","call","state","dragging","_stickRef","createRef","_baseRef","_throttleMoveCallback","lastCall","event","now","Date","getTime","throttleAmount","throttle","move","_boundMouseUp","_mouseUp","_boundMouseMove","_mouseMove","prototype","_updatePos","coordinates","window","requestAnimationFrame","setState","type","x","relativeX","y","relativeY","direction","_mouseDown","e","disabled","_parentRect","current","getBoundingClientRect","MouseDown","addEventListener","MouseUp","MouseMove","TouchEnd","TouchMove","start","_getDirection","atan2","_getWithinBounds","value","halfBaseSize","_baseSize","absoluteX","absoluteY","clientX","clientY","touches","left","top","Math","axisX","axisY","undefined","removeEventListener","stop","_getBaseStyle","baseColor","baseSizeString","height","width","background","borderRadius","display","justifyContent","alignItems","_getStickStyle","stickColor","stickSize","stickStyle","cursor","flexShrink","Object","assign","position","transform","render","size","baseStyle","createElement","className","onMouseDown","bind","onTouchStart","ref","style","Component","exports"],"sources":["../../src/Joystick.tsx"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"script"}